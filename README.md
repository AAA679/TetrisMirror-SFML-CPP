

<p align="center">
  <a href="https://github.com/AAA679/TetrisMirror-SFML-CPP">
    <img src="https://github.com/user-attachments/assets/0a5eec2c-4724-4e4f-b8fc-3224985f33f9" alt="Logo" width="256" height="256">
  </a>

  <h3 align="center">TetrisMirror-SFML</h3>
  <p>
    	TetrisMirror 是一个基于 SFML 的状态机模型俄罗斯方块游戏项目，使用 C++ 语言开发。该项目通过经典的俄罗斯方块游戏展示了 SFML 的强大功能，同时为开发者提供了一个学习和改进 C++ 游戏编程的基础。项目采用了基于状态机的 StateStack 模式管理游戏状态，具有友好的用户界面、多样的游戏功能和灵活的设置选项。
  </p>

## 演示视频

https://github.com/user-attachments/assets/e5621c4c-71df-4f42-861e-5346111dbf85

## 目录

[项目简介](#项目简介)

[功能需求](#功能需求)

- [任务一](#任务一)
- [任务二](#任务二)
- [任务三](#任务三)
- [任务四](#任务四)
- [补充功能](#补充功能)

[系统设计说明](#系统设计说明)

- [数据结构说明](#数据结构说明)
- [程序功能说明](#程序功能说明)
  - [核心模块](#核心模块)  
  - [GUI模块](#gui模块)
  - [账号管理模块](#账号管理模块)
  - [存档管理模块](#存档管理模块)
  - [游戏设置模块](#游戏设置模块)
  - [音频模块](#音频模块)
  - [游戏资源管理模块](#游戏资源管理模块)
  - [按键-游戏命令模块](#按键-游戏命令模块)
  - [游戏局内模块](#游戏局内模块)
  - [游戏界面模块](#游戏界面模块)
  - [工具模块](#工具模块)
- [运行流程图](#运行流程图)

[实现环境](#实现环境)

- [设计平台要求](#设计平台要求)
- [运行环境要求](#运行环境要求)

[作者](#作者)

[版权说明](#版权说明)

## 功能需求

### 需求一
1. **友好的界面**：设计直观、美观且易于操作的用户界面。
2. **方块生成和预告**：随机生成各种方块，并提前预告给玩家，以便做出合理的决策。
3. **方块自动下降**：方块应以一定速度从顶部向底部自动下降。
4. **方块移动和旋转**：玩家通过键盘控制方块的左右移动和旋转，调整方块的位置和方向。
5. **消行功能**：当一行被方块填满时，自动消去该行并更新得分。
6. **计分算法**：设计合理的计分算法，根据消除行数、棋盘尺寸、下落速度等因素计算得分。
7. **游戏结束判断**：当无法继续摆放方块时，判断游戏结束并进行相应处理。

### 需求二
1. **存档与读取**：支持通过文件保存游戏进度，并从存档中恢复游戏。
2. **临时暂停和恢复**：提供游戏暂停和恢复功能。
3. **玩家信息存档和读取**：支持多玩家的存档和读取，保存玩家的游戏记录和个人设置。

### 需求三
1. **游戏参数设置**：提供自定义游戏参数的功能，如方块下落速度、棋盘大小等。
2. **计分和游戏排行榜**：计算分数并展示游戏排行榜。

### 任务四
1. **更友好的用户界面**：增加选择方块样式、切换背景、显示游戏规则简介等功能。
2. **背景音乐和音效**：支持播放和切换背景音乐，增强游戏氛围。
3. **高级设置功能**：支持按键和快捷键设置，恢复默认设置，管理存档等功能。

### 补充功能
- **特殊方块**：如魔法变形方块，可变形为任意方块，丰富游戏玩法。
- **落点预览**：在方块最终落点显示虚影，辅助玩家操作。
- **连击加成**：一次消除多行时，显示连击图标并获得得分倍率加成。
- **无极自定义棋盘尺寸**：支持任意自定义棋盘尺寸，棋盘大小仅受屏幕分辨率限制。
- **科学计分算法**：根据棋盘尺寸和下落速度等因素调整得分，统一排行榜标准。
- **无限玩家多存档**：支持无限数量的玩家注册和多存档。
- **完善的账号管理系统**：实现账号登录、注册、密码验证等功能。

## 系统设计说明

### 文件结构说明
```
filetree 
├── LICENSE.txt
├── README.md
├── CMakeLists.txt
├── /Inc/ 头文件目录
├── /Src/ 源文件目录
├── /Media/ 静态资源目录
├── /Accounts/ 用户数据目录
└── /实训说明/ 项目文档
```

![image](https://github.com/user-attachments/assets/3849810f-e030-4f46-8ed8-72f79b933f9e)

## 运行流程图

![image](https://github.com/user-attachments/assets/941a4be2-2a22-4370-a0d6-d9eb0b753ea9)

### 程序功能说明

#### 核心模块
- **Application.h**：游戏主程序，包含游戏主循环，使用固定步进技术保持每秒60帧运行。
- **State.h**：状态抽象基类，定义游戏状态的基本方法，如渲染、更新、处理输入等。
- **StateStack.h**：状态栈，实现游戏状态的管理，协调各个页面的运行逻辑。

#### GUI模块
- **Component.h**：GUI构件类，按钮、文本框和标签的抽象基类。
- **Button.h**：按钮类，派生于`Component`类。
- **TextField.h**：文本框类，派生于`Component`类。
- **Label.h**：标签类，实时更新与展示设置状态。
- **Container.h**：容器类，用于管理页面中的构件与键盘交互。

#### 账号管理模块
- **Accounts.h**：账户管理模块，负责账户的按键映射和文件操作。
- **LoginState.h**：登录或注册页面，与`Accounts`类通信。

#### 存档管理模块
- **Saves.h**：存档类，管理游戏状态的存取。
- **LoadSavesState.h**：加载存档页面，实现存档文件读取。
- **SaveGameState.h**：游戏存档页面，实现存档文件写入。

#### 游戏设置模块
- **KeySettingsState.h**：按键设置页面，可调整按键映射、开关音乐、切换方块风格等。
- **GameSettingsState.h**：游戏难度设置页面，可自定义方块下落速度和棋盘尺寸。

#### 音频模块
- **SoundPlayer.h**：音效播放器类，使用`list`容器管理音效资源。
- **MusicPlayer.h**：音乐播放器类，采用流媒体方式读取音乐文件。

#### 游戏资源管理模块
- **ResourceHolder.h**：资源管理器模板类，实例化管理音乐、纹理、音效和字体资源。
- **ResourceIdentifiers.h**：资源标识符类，定义资源的标识符枚举类型。

#### 按键-游戏命令模块
- **Command.h**：命令类，将键盘输入转化为游戏命令，并发送至`GameState`对象。
- **CommandQueue.h**：命令队列，处理游戏命令。

#### 游戏局内模块
- **GameState.h**：游戏进行页面，包含俄罗斯方块的主要逻辑。
- **MagicState.h**：魔法变形方块页面。
- **PauseState.h**：游戏暂停页面。
- **GameOverState.h**：游戏结束页面。

#### 游戏界面模块
- **TitleState.h**：标题页面，展示游戏标题和说明。
- **MenuState.h**：菜单页面，提供开始新游戏、载入存档、按键设置等选项。
- **RankState.h**：排行榜页面，展示所有玩家的最高分排名。

#### 工具模块
- **Utility.h**：工具类，提供常用函数，如生成随机数、字符串操作等。
- **Foreach.h**：遍历工具类，提供通用的遍历功能。



## 实现环境

- **设计平台要求**
  - IDE: Visual Studio 2022
  - 编译器版本：MSVC 2022
  - SFML库版本：2.5.1
  - C++标准： C++17
- **运行环境要求**
  - 需要配置SFML环境并使用Visual Studio 2017以上版本编译运行。

### 作者

2790226109@qq.com

### 版权说明

该项目签署了MIT 授权许可，详情请参阅 [LICENSE.txt](https://github.com/shaojintian/Best_README_template/blob/master/LICENSE.txt)





